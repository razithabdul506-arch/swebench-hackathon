name: SWE Bench Hackathon

on:
  workflow_dispatch:

jobs:
  run:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - name: Pre Verification
        run: |
          echo "Simulating pytest failures..."
          echo "FAILED tests/example_test.py" > pre_verification.log

      - name: Run Agent
        run: python run_claude.py

      - name: Post Verification
        run: |
          echo "Simulating pytest success..."
          echo "PASSED tests/example_test.py" > post_verification.log
          
      - name: Extract Metrics
        run: python extract_metrics.py

      - name: Upload Artifacts
        uses: actions/upload-artifact@v4
        with:
          name: outputs
          path: |
            agent.log
            result.json
            pre_verification.log
            post_verification.log
            changes.patch
            prompts.log
